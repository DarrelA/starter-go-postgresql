package jwt

import (
	"encoding/base64"
	"time"
)

const testTTL = 360 * time.Minute

var tokenTests = []struct {
	name            string
	validPrivateKey bool
	validPublicKey  bool
	expectedErrMsg  string
	privateKey      string
	publicKey       string
}{
	{
		name: "2048 bit key size", validPrivateKey: true, validPublicKey: true,
		privateKey: "LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRQ3pHNEg5NS9ueGd2T2UKMmZJZzh6aWdheERRWlovbE0ybGRvODRSdU84bmJ5c0h4T2RqNE1Db2czSGkzN2ZXa2tjN1RoSHFib3ZaVDdCagpIQmpDWkp3UTlFenZRdHJPUTRTSDU0aVlUY0Uya0xDcU9tcVNqZndEY2NkWGxTSFA5NFQ4ckE0TkZhdHVQMGU5CmhaN3BScnl6UER0TlNMMGxOcFJrZjZOY3dwcGxqVVJmZno5Y00wRzBNelBuSjQrZ29HcXpsVS96aEJHbzdkeDMKSDh5SUZ1V2pTWU51b2RjT3ErQ2FIQWdIWGt6NTVNNHVpcVJaN0dnNlZnK1hqNTF3SCtrRm9zcmtKS3NvaWhoZgp4c1RoTkx3d25aYXppTTkrZXBkNm9BUUlsQWUyazVlSnloYW9ickZEU3IzWnE0Z2NOeUpNaTRYQUdiVnpxU0lrCmltaGFTSmcvQWdNQkFBRUNnZ0VBRURjQ0pwSlNUL21RTHdaQjJVRjd2bXVDK3dMcTgyS2JVWkFXQkxKajZ3T0cKOTBOREdZazI3VC95Z2JJZTlXemZ5RnJjaDF5WkNrUkxJK1hleUtFNEpJRjIxNXNMV1JkeFpQdTMrT1hpZzBYeQpkZGw5Q0NYcU5nWkpJRURrUTBJcTNDbllIeVRNNmk4T0Y4dlpqay8wOUhCcHJxajlBQTlOWnVoMm56RmxBMDF4CncyWUd4MGFyakthZGcxV3FiVGN2dHJOb1R5cCtkcjlSU0hObklramYwM1hRSDhEcDR2N013NHd3NFNPMWNNdWsKMmhLWTBvQnB6dlkwenNscEV2TU03WFJiTWlFY0VzTEVZSmcxaWNaSjcyak9rWmJaOE9HQVk4N1pjQ3Fwc1lGUwpLSktNOU80SmFpZ3d3VFcxb2w3Y3Ruckhxa3pBOFg1RGltNTJiZ2pYQVFLQmdRRGlycmp4clV2WnUydGdBODk2CkxzNURES0hpblMrWUZrcHdZeHExK24rM1dEWkFBZWIyTDc1MWU2OVpaZlhHWU55ZWJrZGhZbmVabmlDWUtIZnQKQytaZDByU1dRblphZVRwWjNFQzZQcUVOM2tYZFRnUjErNjZ1RVA2VGxDY0VxTmlNaTNxTjhUR2ZGUFVKbWpxKwpIbzZJNVp3QXJvN2pZdVFtUU53YkVyTk5Qd0tCZ1FES1JaendhL1M1ZjhZc2dCY21kUHJzeUZXZmFBN0FIMkU5CmVZbVRTbjB1Q01tdnVvMDZ6dHlEM1Bxd3IvUExaek5PVGVrSDRSNE5vNjROTXM1dVV4NWpTWmx0MkhGMktlK08KUmgwMW9jenRwejcrbS9qcEpUaEIzWlgzUXJWbm03cExrV0l2MForWEZLU3EzRUxMSndJYXl4RCs3MEE1Q2t1dQpYQk4xbjFqMUFRS0JnUUMzUU5MSXBmVTgxdlB1RWdhSDJ4RHFTV3NSM1VyZG81K1lEYlpKU1hJNFVUckNNZ2Q2CkhJelhReDgxb1dTNGRCUEdqSlp1RndGakVkOTl3ckY0MC9idkFHajNWRkdEd0o4NGlBTlh6VXU3LzJYeGk2RzEKazdyYWcyaWErOWt6UGlDYU5pUGtYZ2xrZHJmRmhJWmFyaTlDWW9Ua1ZEbTFmM3U3cFJHTFhXblFWd0tCZ1FDUwoyKzR4aFVCZStvMkpPOHNUS2ZZUnV2YW4wV1o4U1l4UmxRKzFPRzBnNGxLRlcxNDFKNEpsM3lqSTVrZU5GRFhsCkVaNHpFVmkvc0dxcnZJcXpBWGhid0ZFOHR0elNYV3BJRTFJYjRZa250N2wrSlFLWlRHUEhOcm91bDJtY2V5M00KdGhiaS8wRHU4WmNKVXZqUUJWZDYycHRSYmFaa2c3d2xNVWNUcklsckFRS0JnUUNCTjRZUjR5Wi9aQXU5RUJqbwpMZDk5c3pZbEs3SHhMdGtkK3R0WmFaeDNWWGlsTDA1elhBQzBKOG5jbVhBK2ppa21Gbys1aEVRTTdPdGlzLzJmCmdFUXgzcEQyQUZrZGRzZ3R3OXQ0SCtUWkdWdnJPUlFFTE95UmNIbzNvMitzcmZENVJLK1QxUzcxUVI0MTN3blcKa25mVlVENlFjb0g2akUrV1lIMTBUSG9QN3c9PQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==",

		publicKey: "LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFzeHVCL2VmNThZTHpudG55SVBNNApvR3NRMEdXZjVUTnBYYVBPRWJqdkoyOHJCOFRuWStEQXFJTng0dCszMXBKSE8wNFI2bTZMMlUrd1l4d1l3bVNjCkVQUk03MExhemtPRWgrZUltRTNCTnBDd3FqcHFrbzM4QTNISFY1VWh6L2VFL0t3T0RSV3JiajlIdllXZTZVYTgKc3p3N1RVaTlKVGFVWkgralhNS2FaWTFFWDM4L1hETkJ0RE16NXllUG9LQnFzNVZQODRRUnFPM2NkeC9NaUJibApvMG1EYnFIWERxdmdtaHdJQjE1TStlVE9Mb3FrV2V4b09sWVBsNCtkY0IvcEJhTEs1Q1NyS0lvWVg4YkU0VFM4Ck1KMldzNGpQZm5xWGVxQUVDSlFIdHBPWGljb1dxRzZ4UTBxOTJhdUlIRGNpVEl1RndCbTFjNmtpSklwb1draVkKUHdJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg==",
	},
	{
		name: "1024 bit key size", validPrivateKey: true, validPublicKey: true,
		privateKey: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlDV3dJQkFBS0JnUUNlYlVQa1RYWnpCUW14Q296ZURESWFXSHQ1djVmTHQxRndhTStWTjZzcHJ5RVdWRnZxCmpTQkR3dW1DLzZIME9vUmJLRFNnWStpM3ptNHZ5STJ4WkZJdk8xYXRsdlNPd3dybkZCWUVCaU1OL1NteFpGdkMKZUFyY254bXRDNkVpQmlLbnJtbDBVMUZmQU91NGxITHpod09tcVU3Vnl4K3M1dFZDVU9WanVnRnJDd0lEQVFBQgpBb0dBQmV6S05EaWRiSEhNeWYwK0JYUHBUOGp0WFVGSUdRdFRGV1FtRjB1TXNETm5obUZEU3NOYWFJNWFrMWFpCkpQTW5UZzF6NG1lNkpWMm9DMHR4MlNlS1YwRE5WdzBxZW1qR0syNVkzeDRaeTRmZ2crR3RUSUV5V0RCOFBnY2wKT1BlRGI1ek56SXArQ1ZHdllaNUMyM1NoalVVa0JZdFowNzBYV0FGd1lEY2kveEVDUVFETHVCV213OW84NjlmYwpZajJ3K2ZjOGVvUHlvT0VMRWIwd0d3UlhpQ1BzSkFpZTJJMkZGdzZEZmtWY2JnMTk3ZXhFREozOGRMK3UxU21ZCmJMNDROeXRaQWtFQXh4V1MrZlAyRnlOU0FvSE02bXkwWmM5NkZxSWJqUTNlRVVLMGR5M0VEbmFlTXo1MDdZQnIKREhKdWpsam5WNkRjcjdMekNzcGJHdzlWOHdhN0V2TVJBd0pBYi9xb0xCck1BMkRBTHV2eGJTNTVzRXpINnI1ego5Vm15M0paOU5JQW8vc3h2MEtESWFiZmF5bnpHTTZCcTJpWEdFVUcrTmQ4VzNrdGRxZU5jVEJwSFFRSkFQVzBWCnJWT3R3WlBmVVBDMXhqc0dLa2VxOXVMTHQyam85TkJ0R0R5aHVvaTA1VURIR1NTL1l0Ykg3OW5VZjRBZHQ0UnkKWXdqdXRWbTAva2c4WG10cSt3SkFNS1Zub01WVjNscTFtOWNrRng2NkxBVVR6dlNZek1pL05lVzRIVGVmb2NXegpVMjZKaW5iWU52aUFIdFV0M01GSjRSaWhNTFU3UVgvT0RWaGRlejFsS3c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==",

		publicKey: "LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FDZWJVUGtUWFp6QlFteENvemVERElhV0h0NQp2NWZMdDFGd2FNK1ZONnNwcnlFV1ZGdnFqU0JEd3VtQy82SDBPb1JiS0RTZ1kraTN6bTR2eUkyeFpGSXZPMWF0Cmx2U093d3JuRkJZRUJpTU4vU214WkZ2Q2VBcmNueG10QzZFaUJpS25ybWwwVTFGZkFPdTRsSEx6aHdPbXFVN1YKeXgrczV0VkNVT1ZqdWdGckN3SURBUUFCCi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQ==",
	},
	{
		name: "512 bit key size", validPrivateKey: true, validPublicKey: true,
		privateKey: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlDV3dJQkFBS0JnUUNlYlVQa1RYWnpCUW14Q296ZURESWFXSHQ1djVmTHQxRndhTStWTjZzcHJ5RVdWRnZxCmpTQkR3dW1DLzZIME9vUmJLRFNnWStpM3ptNHZ5STJ4WkZJdk8xYXRsdlNPd3dybkZCWUVCaU1OL1NteFpGdkMKZUFyY254bXRDNkVpQmlLbnJtbDBVMUZmQU91NGxITHpod09tcVU3Vnl4K3M1dFZDVU9WanVnRnJDd0lEQVFBQgpBb0dBQmV6S05EaWRiSEhNeWYwK0JYUHBUOGp0WFVGSUdRdFRGV1FtRjB1TXNETm5obUZEU3NOYWFJNWFrMWFpCkpQTW5UZzF6NG1lNkpWMm9DMHR4MlNlS1YwRE5WdzBxZW1qR0syNVkzeDRaeTRmZ2crR3RUSUV5V0RCOFBnY2wKT1BlRGI1ek56SXArQ1ZHdllaNUMyM1NoalVVa0JZdFowNzBYV0FGd1lEY2kveEVDUVFETHVCV213OW84NjlmYwpZajJ3K2ZjOGVvUHlvT0VMRWIwd0d3UlhpQ1BzSkFpZTJJMkZGdzZEZmtWY2JnMTk3ZXhFREozOGRMK3UxU21ZCmJMNDROeXRaQWtFQXh4V1MrZlAyRnlOU0FvSE02bXkwWmM5NkZxSWJqUTNlRVVLMGR5M0VEbmFlTXo1MDdZQnIKREhKdWpsam5WNkRjcjdMekNzcGJHdzlWOHdhN0V2TVJBd0pBYi9xb0xCck1BMkRBTHV2eGJTNTVzRXpINnI1ego5Vm15M0paOU5JQW8vc3h2MEtESWFiZmF5bnpHTTZCcTJpWEdFVUcrTmQ4VzNrdGRxZU5jVEJwSFFRSkFQVzBWCnJWT3R3WlBmVVBDMXhqc0dLa2VxOXVMTHQyam85TkJ0R0R5aHVvaTA1VURIR1NTL1l0Ykg3OW5VZjRBZHQ0UnkKWXdqdXRWbTAva2c4WG10cSt3SkFNS1Zub01WVjNscTFtOWNrRng2NkxBVVR6dlNZek1pL05lVzRIVGVmb2NXegpVMjZKaW5iWU52aUFIdFV0M01GSjRSaWhNTFU3UVgvT0RWaGRlejFsS3c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==",

		publicKey: "LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FDZWJVUGtUWFp6QlFteENvemVERElhV0h0NQp2NWZMdDFGd2FNK1ZONnNwcnlFV1ZGdnFqU0JEd3VtQy82SDBPb1JiS0RTZ1kraTN6bTR2eUkyeFpGSXZPMWF0Cmx2U093d3JuRkJZRUJpTU4vU214WkZ2Q2VBcmNueG10QzZFaUJpS25ybWwwVTFGZkFPdTRsSEx6aHdPbXFVN1YKeXgrczV0VkNVT1ZqdWdGckN3SURBUUFCCi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQ==",
	},
	{
		name: "Fake keys", validPrivateKey: false, validPublicKey: false,
		expectedErrMsg: "invalid key: Key must be a PEM encoded PKCS1 or PKCS8 key",
		privateKey:     base64.StdEncoding.EncodeToString([]byte("valid_private_key")),
		publicKey:      base64.StdEncoding.EncodeToString([]byte("valid_public_key")),
	},
	{
		name: "Invalid Private Key", validPrivateKey: false, validPublicKey: true,
		expectedErrMsg: "invalid key: Key must be a PEM encoded PKCS1 or PKCS8 key",
		privateKey:     "invalid_key",
		publicKey:      "LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FDZWJVUGtUWFp6QlFteENvemVERElhV0h0NQp2NWZMdDFGd2FNK1ZONnNwcnlFV1ZGdnFqU0JEd3VtQy82SDBPb1JiS0RTZ1kraTN6bTR2eUkyeFpGSXZPMWF0Cmx2U093d3JuRkJZRUJpTU4vU214WkZ2Q2VBcmNueG10QzZFaUJpS25ybWwwVTFGZkFPdTRsSEx6aHdPbXFVN1YKeXgrczV0VkNVT1ZqdWdGckN3SURBUUFCCi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQ==",
	},
	{
		name: "Invalid Public Key", validPrivateKey: true, validPublicKey: false,
		expectedErrMsg: "invalid key: Key must be a PEM encoded PKCS1 or PKCS8 key",
		privateKey:     "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlDV3dJQkFBS0JnUUNlYlVQa1RYWnpCUW14Q296ZURESWFXSHQ1djVmTHQxRndhTStWTjZzcHJ5RVdWRnZxCmpTQkR3dW1DLzZIME9vUmJLRFNnWStpM3ptNHZ5STJ4WkZJdk8xYXRsdlNPd3dybkZCWUVCaU1OL1NteFpGdkMKZUFyY254bXRDNkVpQmlLbnJtbDBVMUZmQU91NGxITHpod09tcVU3Vnl4K3M1dFZDVU9WanVnRnJDd0lEQVFBQgpBb0dBQmV6S05EaWRiSEhNeWYwK0JYUHBUOGp0WFVGSUdRdFRGV1FtRjB1TXNETm5obUZEU3NOYWFJNWFrMWFpCkpQTW5UZzF6NG1lNkpWMm9DMHR4MlNlS1YwRE5WdzBxZW1qR0syNVkzeDRaeTRmZ2crR3RUSUV5V0RCOFBnY2wKT1BlRGI1ek56SXArQ1ZHdllaNUMyM1NoalVVa0JZdFowNzBYV0FGd1lEY2kveEVDUVFETHVCV213OW84NjlmYwpZajJ3K2ZjOGVvUHlvT0VMRWIwd0d3UlhpQ1BzSkFpZTJJMkZGdzZEZmtWY2JnMTk3ZXhFREozOGRMK3UxU21ZCmJMNDROeXRaQWtFQXh4V1MrZlAyRnlOU0FvSE02bXkwWmM5NkZxSWJqUTNlRVVLMGR5M0VEbmFlTXo1MDdZQnIKREhKdWpsam5WNkRjcjdMekNzcGJHdzlWOHdhN0V2TVJBd0pBYi9xb0xCck1BMkRBTHV2eGJTNTVzRXpINnI1ego5Vm15M0paOU5JQW8vc3h2MEtESWFiZmF5bnpHTTZCcTJpWEdFVUcrTmQ4VzNrdGRxZU5jVEJwSFFRSkFQVzBWCnJWT3R3WlBmVVBDMXhqc0dLa2VxOXVMTHQyam85TkJ0R0R5aHVvaTA1VURIR1NTL1l0Ykg3OW5VZjRBZHQ0UnkKWXdqdXRWbTAva2c4WG10cSt3SkFNS1Zub01WVjNscTFtOWNrRng2NkxBVVR6dlNZek1pL05lVzRIVGVmb2NXegpVMjZKaW5iWU52aUFIdFV0M01GSjRSaWhNTFU3UVgvT0RWaGRlejFsS3c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==",
		publicKey:      "invalid_key",
	},
	{
		name: "Empty keys", validPrivateKey: false, validPublicKey: false,
		expectedErrMsg: "invalid key: Key must be a PEM encoded PKCS1 or PKCS8 key",
		privateKey:     "", publicKey: ""},
}
